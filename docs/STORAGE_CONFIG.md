# Cloud Storage 運用設定

## 1. フォルダ構成

本プロジェクトでは、Cloud Storage for Firebase を音声ファイルの保存場所として利用します。

- **バケット**: Firebaseプロジェクトのデフォルトバケット
- **フォルダパス**: `audios/{userId}/{timestamp}_{original_filename}`

### この形式を採用する理由

- **`audios/`**: すべての音声ファイルをこのフォルダに集約します。
- **`{userId}`**: どのユーザーがアップロードしたファイルかを明確にし、セキュリティルールでのアクセス制御を容易にします。
- **`{timestamp}_{original_filename}`**: ファイル名の衝突を防ぎつつ、元のファイル名を判別しやすくします。

このパス命名規則は、`components/admin-form.tsx` 内のアップロード処理で実装されています。

## 2. セキュリティルール

Cloud Storageのセキュリティは、コンソールで設定するルールによって担保されます。

**基本方針:**
- **読み取り**: 全員に許可します。これにより、Webサイト訪問者は誰でも音声を再生できます。
- **書き込み (作成・更新・削除)**: 認証済みのユーザーが、自身の `userId` パスに対してのみ操作できるように厳格に制限します。

具体的なルールは `docs/SECURITY_RULES.md` を参照してください。